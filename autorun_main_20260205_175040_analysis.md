# autorun_main_20260205_175040.log 运行状态分析

## 结论概览
- 脚本整体处于“持续运行、可交易但有数据新鲜度压力”的状态。
- WS 聚合器连接总体稳定，发生过重连但有自动回填，未见崩溃。
- 买入/清仓逻辑基本按设计执行：有 BUY/SELL 挂单状态持续输出，sell 信号在无持仓时会被忽略，符合保护逻辑。
- maker 波段逻辑在执行，但多数标的挂单长期 LIVE、成交偏少，存在流动性不足/盘口更新不足迹象。
- 需要重点关注共享 WS 缓存“过期软降级”频率偏高，以及个别 token 长时间未更新。

## 1) WS 与 REST 连接状态

### 观察
- 启动后正常建立 WS 聚合连接并订阅 59 个 token，模式为“增量订阅”。
- 日志中存在“重连后缓存回填”记录，说明连接有抖动但自动恢复。
- 子策略日志经常出现：`WebSocket bid 返回 None`、`缓存数据过期`，并提示使用过期缓存软降级。
- 尾部仍有 `[WS][SHARED] seq` 增长与实时 bid/ask，说明数据流未全局中断。

### 评估
- **整体正常，但存在局部数据新鲜度问题。**
- 该行为与代码预期一致：当缓存过期时，BID 路径可返回 None 触发 REST fallback；ASK 路径允许“过期缓存软降级”。

## 2) 买入逻辑与清仓逻辑

### 观察
- 存在大量 `[MAKER][BUY] 挂单` 与 `[MAKER][BUY] 挂单状态`，说明买入流程持续运行。
- 存在大量 `[MAKER][SELL] 挂单状态`，且仍在更新，清仓/卖出流程持续运行。
- copytrade sell 信号处理中，若无持仓会显式“忽略 sell 信号，未进入 maker 队列”。
- 有 `[EXIT-CLEAN]` 任务启动记录，说明清仓流程可被触发执行。

### 评估
- **运行逻辑基本符合代码设计预期。**
- 但尾部多个任务仍处于 `status=LIVE + sold=0 / filled=0`，说明“下单成功 != 成交成功”；执行层正常，成交层受市场流动性与价格位置影响。

## 3) maker 波段逻辑

### 观察
- 持续出现 SELL 状态跟踪，包含价格、已卖、剩余、状态。
- 代码中的激进卖出逻辑（超时下调挂价、触底锁价）具备机制，但主日志样本中未明显看到大量激进降价触发痕迹。
- 心跳中长期出现“信号超时: X 分钟无信号 / 阈值 60 分钟”，表明有不少市场长时间未触发有效交易信号。

### 评估
- **maker 逻辑在跑，策略状态机没有卡死迹象；但触发效率/成交效率一般。**
- 更像“行情条件或流动性不佳导致的低成交”，不是策略线程本身故障。

## 4) 异常与值得关注点

1. **缓存过期软降级频繁**
   - 多处出现 `缓存数据过期 ... 使用过期缓存软降级`。
   - 风险：定价可能偏离最新盘口，影响挂单质量。

2. **WS 数据缺失告警**
   - `WebSocket bid 返回 None（可能原因：快照过期或数据缺失）`。
   - 说明个别 token 会进入 BID 数据空洞。

3. **健康检查持续告警**
   - 尾部显示有 token 超过 30 分钟未更新（52 分钟）。
   - 长尾 token 流动性或订阅有效性需排查。

4. **信号超时普遍存在**
   - 多个 RUN 状态显示信号超时分钟数持续增长。
   - 不一定是 bug，但提示策略覆盖的 token 中相当一部分有效信号稀疏。

## 5) 可补充检查点（你未提但建议）

1. **成交率指标**：统计 `LIVE->FILLED/CANCELLED` 转化率，按 token 分组。
2. **缓存年龄分布**：统计 `updated_at` 的 P50/P95，验证是否是少数 token 拖累。
3. **重连相关性能**：记录每次重连后 5 分钟内的 None 比例与成交率是否恶化。
4. **信号来源质量**：copytrade 侧 sell 信号中“无持仓被忽略”的占比偏高，建议追踪上游信号与本地仓位的一致性。
5. **参数分层**：对低流动性 token 单独使用更保守或更激进的 maker 参数（tick、超时、floor/ceiling）。

## 6) 整体评价

- **运行稳定性：7.5/10**（主进程稳定、子任务持续、状态可恢复）
- **交易执行有效性：6/10**（挂单很多，但部分长期不成交）
- **数据质量与可用性：6/10**（WS 总体可用，但缓存过期与 None 告警偏多）

综合看，这套脚本处于“**可持续运行、但需要优化数据新鲜度和成交效率**”的状态。
